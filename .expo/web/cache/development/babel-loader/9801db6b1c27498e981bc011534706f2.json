{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\Mansour\\\\Desktop\\\\OrientLine\\\\app\\\\app\\\\screens\\\\RegisterScreen.js\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport * as Yup from \"yup\";\nimport Screen from \"../components/Screen\";\nimport { ErrorMessage, Form, FormField, SubmitButton } from \"../components/forms\";\nimport ActivityIndicator from \"../components/ActivityIndicator\";\nimport authApi from \"../api/auth\";\nimport useAuth from \"../auth/useAuth\";\nimport useApi from \"../hooks/useApi\";\nimport usersApi from \"../api/users\";\nvar validationSchema = Yup.object().shape({\n  name: Yup.string().required().label(\"Name\"),\n  email: Yup.string().required().email().label(\"Email\"),\n  password: Yup.string().required().min(4).label(\"Password\")\n});\n\nfunction RegisterScreen() {\n  var registerApi = useApi(usersApi.register);\n  var loginApi = useApi(authApi.login);\n  var auth = useAuth();\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      error = _useState2[0],\n      setError = _useState2[1];\n\n  var handleSubmit = function handleSubmit(userInfo) {\n    var result, _await$loginApi$reque, authToken;\n\n    return _regeneratorRuntime.async(function handleSubmit$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(registerApi.request(userInfo));\n\n          case 2:\n            result = _context.sent;\n\n            if (result.ok) {\n              _context.next = 6;\n              break;\n            }\n\n            if (result.data) setError(result.data.error);else {\n              setError(\"An unexpected error occurred.\");\n              console.log(result);\n            }\n            return _context.abrupt(\"return\");\n\n          case 6:\n            _context.next = 8;\n            return _regeneratorRuntime.awrap(loginApi.request(userInfo.email, userInfo.password));\n\n          case 8:\n            _await$loginApi$reque = _context.sent;\n            authToken = _await$loginApi$reque.data;\n            auth.logIn(authToken);\n\n          case 11:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  return React.createElement(React.Fragment, null, React.createElement(ActivityIndicator, {\n    visible: registerApi.loading || loginApi.loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 4\n    }\n  }), React.createElement(Screen, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 4\n    }\n  }, React.createElement(Form, {\n    initialValues: {\n      name: \"\",\n      email: \"\",\n      password: \"\"\n    },\n    onSubmit: handleSubmit,\n    validationSchema: validationSchema,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 5\n    }\n  }, React.createElement(ErrorMessage, {\n    error: error,\n    visible: error,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 6\n    }\n  }), React.createElement(FormField, {\n    autoCapitalize: \"none\",\n    autoCorrect: false,\n    icon: \"account-edit\",\n    name: \"password\",\n    placeholder: \"Type de compte\",\n    textContentType: \"password\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 6\n    }\n  }), React.createElement(FormField, {\n    autoCorrect: false,\n    icon: \"account\",\n    name: \"name\",\n    placeholder: \"Nom\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 6\n    }\n  }), React.createElement(FormField, {\n    autoCapitalize: \"none\",\n    autoCorrect: false,\n    icon: \"email\",\n    keyboardType: \"email-address\",\n    name: \"email\",\n    placeholder: \"Email\",\n    textContentType: \"emailAddress\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 6\n    }\n  }), React.createElement(FormField, {\n    autoCapitalize: \"none\",\n    autoCorrect: false,\n    icon: \"lock\",\n    name: \"password\",\n    placeholder: \"Mot de passe\",\n    secureTextEntry: true,\n    textContentType: \"password\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 6\n    }\n  }), React.createElement(SubmitButton, {\n    title: \"Inscription\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 6\n    }\n  }))));\n}\n\nvar styles = StyleSheet.create({\n  container: {\n    padding: 10\n  }\n});\nexport default RegisterScreen;","map":{"version":3,"sources":["C:/Users/Mansour/Desktop/OrientLine/app/app/screens/RegisterScreen.js"],"names":["React","useState","Yup","Screen","ErrorMessage","Form","FormField","SubmitButton","ActivityIndicator","authApi","useAuth","useApi","usersApi","validationSchema","object","shape","name","string","required","label","email","password","min","RegisterScreen","registerApi","register","loginApi","login","auth","error","setError","handleSubmit","userInfo","request","result","ok","data","console","log","authToken","logIn","loading","styles","container","StyleSheet","create","padding"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { StyleSheet } from \"react-native\";\nimport * as Yup from \"yup\";\n\nimport Screen from \"../components/Screen\";\nimport {\n\tErrorMessage,\n\tForm,\n\tFormField,\n\tSubmitButton,\n} from \"../components/forms\";\nimport ActivityIndicator from \"../components/ActivityIndicator\";\n\nimport authApi from \"../api/auth\";\nimport useAuth from \"../auth/useAuth\";\nimport useApi from \"../hooks/useApi\";\nimport usersApi from \"../api/users\";\n\nconst validationSchema = Yup.object().shape({\n\tname: Yup.string().required().label(\"Name\"),\n\temail: Yup.string().required().email().label(\"Email\"),\n\tpassword: Yup.string().required().min(4).label(\"Password\"),\n});\n\nfunction RegisterScreen() {\n\tconst registerApi = useApi(usersApi.register);\n\tconst loginApi = useApi(authApi.login);\n\tconst auth = useAuth();\n\tconst [error, setError] = useState();\n\n\tconst handleSubmit = async (userInfo) => {\n\t\tconst result = await registerApi.request(userInfo);\n\n\t\tif (!result.ok) {\n\t\t\tif (result.data) setError(result.data.error);\n\t\t\telse {\n\t\t\t\tsetError(\"An unexpected error occurred.\");\n\t\t\t\tconsole.log(result);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tconst { data: authToken } = await loginApi.request(\n\t\t\tuserInfo.email,\n\t\t\tuserInfo.password\n\t\t);\n\t\tauth.logIn(authToken);\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<ActivityIndicator\n\t\t\t\tvisible={registerApi.loading || loginApi.loading}\n\t\t\t/>\n\t\t\t<Screen style={styles.container}>\n\t\t\t\t<Form\n\t\t\t\t\tinitialValues={{ name: \"\", email: \"\", password: \"\" }}\n\t\t\t\t\tonSubmit={handleSubmit}\n\t\t\t\t\tvalidationSchema={validationSchema}\n\t\t\t\t>\n\t\t\t\t\t<ErrorMessage error={error} visible={error} />\n\t\t\t\t\t<FormField\n\t\t\t\t\t\tautoCapitalize=\"none\"\n\t\t\t\t\t\tautoCorrect={false}\n\t\t\t\t\t\ticon=\"account-edit\"\n\t\t\t\t\t\tname=\"password\"\n\t\t\t\t\t\tplaceholder=\"Type de compte\" //liste déroulante\n\t\t\t\t\t\ttextContentType=\"password\"\n\t\t\t\t\t/>\n\t\t\t\t\t<FormField\n\t\t\t\t\t\tautoCorrect={false}\n\t\t\t\t\t\ticon=\"account\"\n\t\t\t\t\t\tname=\"name\"\n\t\t\t\t\t\tplaceholder=\"Nom\"\n\t\t\t\t\t/>\n\t\t\t\t\t<FormField\n\t\t\t\t\t\tautoCapitalize=\"none\"\n\t\t\t\t\t\tautoCorrect={false}\n\t\t\t\t\t\ticon=\"email\"\n\t\t\t\t\t\tkeyboardType=\"email-address\"\n\t\t\t\t\t\tname=\"email\"\n\t\t\t\t\t\tplaceholder=\"Email\"\n\t\t\t\t\t\ttextContentType=\"emailAddress\"\n\t\t\t\t\t/>\n\t\t\t\t\t<FormField\n\t\t\t\t\t\tautoCapitalize=\"none\"\n\t\t\t\t\t\tautoCorrect={false}\n\t\t\t\t\t\ticon=\"lock\"\n\t\t\t\t\t\tname=\"password\"\n\t\t\t\t\t\tplaceholder=\"Mot de passe\"\n\t\t\t\t\t\tsecureTextEntry\n\t\t\t\t\t\ttextContentType=\"password\"\n\t\t\t\t\t/>\n\t\t\t\t\t<SubmitButton title=\"Inscription\" />\n\t\t\t\t</Form>\n\t\t\t</Screen>\n\t\t</>\n\t);\n}\n\nconst styles = StyleSheet.create({\n\tcontainer: {\n\t\tpadding: 10,\n\t},\n});\n\nexport default RegisterScreen;\n"]},"metadata":{},"sourceType":"module"}