{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\Mansour\\\\Desktop\\\\OrientLine\\\\app\\\\app\\\\screens\\\\RegisterScreen.js\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport * as Yup from \"yup\";\nimport CategoryPickerItem from \"../components/CategoryPickerItem\";\nimport Screen from \"../components/Screen\";\nimport { ErrorMessage, Form, FormField, FormPicker, SubmitButton } from \"../components/forms\";\nimport ActivityIndicator from \"../components/ActivityIndicator\";\nimport authApi from \"../api/auth\";\nimport useAuth from \"../auth/useAuth\";\nimport useApi from \"../hooks/useApi\";\nimport usersApi from \"../api/users\";\nvar validationSchema = Yup.object().shape({\n  accountType: Yup.object().required().label(\"AccountType\"),\n  name: Yup.string().required().label(\"Name\"),\n  email: Yup.string().required().email().label(\"Email\"),\n  password: Yup.string().required().min(4).label(\"Password\")\n});\n\nfunction RegisterScreen() {\n  var registerApi = useApi(usersApi.register);\n  var loginApi = useApi(authApi.login);\n  var auth = useAuth();\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      error = _useState2[0],\n      setError = _useState2[1];\n\n  var accountTypes = [{\n    backgroundColor: \"#00b0f0\",\n    icon: \"account\",\n    label: \"Particulier\",\n    value: 1\n  }, {\n    backgroundColor: \"#00f0b0\",\n    icon: \"account-cash\",\n    label: \"Professionnel\",\n    value: 2\n  }];\n\n  var handleSubmit = function handleSubmit(userInfo) {\n    var result, _await$loginApi$reque, authToken;\n\n    return _regeneratorRuntime.async(function handleSubmit$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(registerApi.request(userInfo));\n\n          case 2:\n            result = _context.sent;\n\n            if (result.ok) {\n              _context.next = 6;\n              break;\n            }\n\n            if (result.data) setError(result.data.error);else {\n              setError(\"An unexpected error occurred.\");\n              console.log(result);\n            }\n            return _context.abrupt(\"return\");\n\n          case 6:\n            _context.next = 8;\n            return _regeneratorRuntime.awrap(loginApi.request(userInfo.email, userInfo.password));\n\n          case 8:\n            _await$loginApi$reque = _context.sent;\n            authToken = _await$loginApi$reque.data;\n            auth.logIn(authToken);\n\n          case 11:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  return React.createElement(React.Fragment, null, React.createElement(ActivityIndicator, {\n    visible: registerApi.loading || loginApi.loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 4\n    }\n  }), React.createElement(Screen, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 4\n    }\n  }, React.createElement(Form, {\n    initialValues: {\n      accountType: \"\",\n      name: \"\",\n      email: \"\",\n      password: \"\"\n    },\n    onSubmit: handleSubmit,\n    validationSchema: validationSchema,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 5\n    }\n  }, React.createElement(ErrorMessage, {\n    error: error,\n    visible: error,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 6\n    }\n  }), React.createElement(FormPicker, {\n    name: \"accountType\",\n    placeholder: \"Type de compte\",\n    items: accountTypes,\n    PickerItemComponent: CategoryPickerItem,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 6\n    }\n  }), React.createElement(FormField, {\n    autoCorrect: false,\n    icon: \"account\",\n    name: \"name\",\n    placeholder: \"Nom\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 6\n    }\n  }), React.createElement(FormField, {\n    autoCapitalize: \"none\",\n    autoCorrect: false,\n    icon: \"email\",\n    keyboardType: \"email-address\",\n    name: \"email\",\n    placeholder: \"Email                  \",\n    textContentType: \"emailAddress\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 6\n    }\n  }), React.createElement(FormField, {\n    autoCapitalize: \"none\",\n    autoCorrect: false,\n    icon: \"lock\",\n    name: \"password\",\n    placeholder: \"Mot de passe\",\n    secureTextEntry: true,\n    textContentType: \"password\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 6\n    }\n  }), React.createElement(SubmitButton, {\n    title: \"Inscription\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 6\n    }\n  }))));\n}\n\nvar styles = StyleSheet.create({\n  container: {\n    padding: 10\n  }\n});\nexport default RegisterScreen;","map":{"version":3,"sources":["C:/Users/Mansour/Desktop/OrientLine/app/app/screens/RegisterScreen.js"],"names":["React","useState","Yup","CategoryPickerItem","Screen","ErrorMessage","Form","FormField","FormPicker","SubmitButton","ActivityIndicator","authApi","useAuth","useApi","usersApi","validationSchema","object","shape","accountType","required","label","name","string","email","password","min","RegisterScreen","registerApi","register","loginApi","login","auth","error","setError","accountTypes","backgroundColor","icon","value","handleSubmit","userInfo","request","result","ok","data","console","log","authToken","logIn","loading","styles","container","StyleSheet","create","padding"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;;AAEA,OAAO,KAAKC,GAAZ,MAAqB,KAArB;AACA,OAAOC,kBAAP;AACA,OAAOC,MAAP;AACA,SACCC,YADD,EAECC,IAFD,EAGCC,SAHD,EAICC,UAJD,EAKCC,YALD;AAOA,OAAOC,iBAAP;AAEA,OAAOC,OAAP;AACA,OAAOC,OAAP;AACA,OAAOC,MAAP;AACA,OAAOC,QAAP;AAEA,IAAMC,gBAAgB,GAAGb,GAAG,CAACc,MAAJ,GAAaC,KAAb,CAAmB;AAC3CC,EAAAA,WAAW,EAAEhB,GAAG,CAACc,MAAJ,GAAaG,QAAb,GAAwBC,KAAxB,CAA8B,aAA9B,CAD8B;AAE3CC,EAAAA,IAAI,EAAEnB,GAAG,CAACoB,MAAJ,GAAaH,QAAb,GAAwBC,KAAxB,CAA8B,MAA9B,CAFqC;AAG3CG,EAAAA,KAAK,EAAErB,GAAG,CAACoB,MAAJ,GAAaH,QAAb,GAAwBI,KAAxB,GAAgCH,KAAhC,CAAsC,OAAtC,CAHoC;AAI3CI,EAAAA,QAAQ,EAAEtB,GAAG,CAACoB,MAAJ,GAAaH,QAAb,GAAwBM,GAAxB,CAA4B,CAA5B,EAA+BL,KAA/B,CAAqC,UAArC;AAJiC,CAAnB,CAAzB;;AAOA,SAASM,cAAT,GAA0B;AACzB,MAAMC,WAAW,GAAGd,MAAM,CAACC,QAAQ,CAACc,QAAV,CAA1B;AACA,MAAMC,QAAQ,GAAGhB,MAAM,CAACF,OAAO,CAACmB,KAAT,CAAvB;AACA,MAAMC,IAAI,GAAGnB,OAAO,EAApB;;AACA,kBAA0BX,QAAQ,EAAlC;AAAA;AAAA,MAAO+B,KAAP;AAAA,MAAcC,QAAd;;AAEA,MAAMC,YAAY,GAAG,CACpB;AACCC,IAAAA,eAAe,EAAE,SADlB;AAECC,IAAAA,IAAI,EAAE,SAFP;AAGChB,IAAAA,KAAK,EAAE,aAHR;AAICiB,IAAAA,KAAK,EAAE;AAJR,GADoB,EAOpB;AACCF,IAAAA,eAAe,EAAE,SADlB;AAECC,IAAAA,IAAI,EAAE,cAFP;AAGChB,IAAAA,KAAK,EAAE,eAHR;AAICiB,IAAAA,KAAK,EAAE;AAJR,GAPoB,CAArB;;AAeA,MAAMC,YAAY,GAAG,SAAfA,YAAe,CAAOC,QAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6CACCZ,WAAW,CAACa,OAAZ,CAAoBD,QAApB,CADD;;AAAA;AACdE,YAAAA,MADc;;AAAA,gBAGfA,MAAM,CAACC,EAHQ;AAAA;AAAA;AAAA;;AAInB,gBAAID,MAAM,CAACE,IAAX,EAAiBV,QAAQ,CAACQ,MAAM,CAACE,IAAP,CAAYX,KAAb,CAAR,CAAjB,KACK;AACJC,cAAAA,QAAQ,CAAC,+BAAD,CAAR;AACAW,cAAAA,OAAO,CAACC,GAAR,CAAYJ,MAAZ;AACA;AARkB;;AAAA;AAAA;AAAA,6CAYcZ,QAAQ,CAACW,OAAT,CACjCD,QAAQ,CAAChB,KADwB,EAEjCgB,QAAQ,CAACf,QAFwB,CAZd;;AAAA;AAAA;AAYNsB,YAAAA,SAZM,yBAYZH,IAZY;AAgBpBZ,YAAAA,IAAI,CAACgB,KAAL,CAAWD,SAAX;;AAhBoB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAArB;;AAmBA,SACC,0CACC,oBAAC,iBAAD;AACC,IAAA,OAAO,EAAEnB,WAAW,CAACqB,OAAZ,IAAuBnB,QAAQ,CAACmB,OAD1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADD,EAIC,oBAAC,MAAD;AAAQ,IAAA,KAAK,EAAEC,MAAM,CAACC,SAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACC,oBAAC,IAAD;AACC,IAAA,aAAa,EAAE;AAAEhC,MAAAA,WAAW,EAAE,EAAf;AAAmBG,MAAAA,IAAI,EAAE,EAAzB;AAA6BE,MAAAA,KAAK,EAAE,EAApC;AAAwCC,MAAAA,QAAQ,EAAE;AAAlD,KADhB;AAEC,IAAA,QAAQ,EAAEc,YAFX;AAGC,IAAA,gBAAgB,EAAEvB,gBAHnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAKC,oBAAC,YAAD;AAAc,IAAA,KAAK,EAAEiB,KAArB;AAA4B,IAAA,OAAO,EAAEA,KAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IALD,EAMC,oBAAC,UAAD;AACC,IAAA,IAAI,EAAC,aADN;AAEC,IAAA,WAAW,EAAC,gBAFb;AAGC,IAAA,KAAK,EAAEE,YAHR;AAIC,IAAA,mBAAmB,EAAE/B,kBAJtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAND,EAcC,oBAAC,SAAD;AACC,IAAA,WAAW,EAAE,KADd;AAEC,IAAA,IAAI,EAAC,SAFN;AAGC,IAAA,IAAI,EAAC,MAHN;AAIC,IAAA,WAAW,EAAC,KAJb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAdD,EAoBC,oBAAC,SAAD;AACC,IAAA,cAAc,EAAC,MADhB;AAEC,IAAA,WAAW,EAAE,KAFd;AAGC,IAAA,IAAI,EAAC,OAHN;AAIC,IAAA,YAAY,EAAC,eAJd;AAKC,IAAA,IAAI,EAAC,OALN;AAMC,IAAA,WAAW,EAAC,yBANb;AAOC,IAAA,eAAe,EAAC,cAPjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IApBD,EA6BC,oBAAC,SAAD;AACC,IAAA,cAAc,EAAC,MADhB;AAEC,IAAA,WAAW,EAAE,KAFd;AAGC,IAAA,IAAI,EAAC,MAHN;AAIC,IAAA,IAAI,EAAC,UAJN;AAKC,IAAA,WAAW,EAAC,cALb;AAMC,IAAA,eAAe,MANhB;AAOC,IAAA,eAAe,EAAC,UAPjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IA7BD,EAsCC,oBAAC,YAAD;AAAc,IAAA,KAAK,EAAC,aAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAtCD,CADD,CAJD,CADD;AAiDA;;AAED,IAAM8C,MAAM,GAAGE,UAAU,CAACC,MAAX,CAAkB;AAChCF,EAAAA,SAAS,EAAE;AACVG,IAAAA,OAAO,EAAE;AADC;AADqB,CAAlB,CAAf;AAMA,eAAe3B,cAAf","sourcesContent":["import React, { useState } from \"react\";\nimport { StyleSheet } from \"react-native\";\nimport * as Yup from \"yup\";\nimport CategoryPickerItem from \"../components/CategoryPickerItem\";\nimport Screen from \"../components/Screen\";\nimport {\n\tErrorMessage,\n\tForm,\n\tFormField,\n\tFormPicker,\n\tSubmitButton,\n} from \"../components/forms\";\nimport ActivityIndicator from \"../components/ActivityIndicator\";\n\nimport authApi from \"../api/auth\";\nimport useAuth from \"../auth/useAuth\";\nimport useApi from \"../hooks/useApi\";\nimport usersApi from \"../api/users\";\n\nconst validationSchema = Yup.object().shape({\n\taccountType: Yup.object().required().label(\"AccountType\"),\n\tname: Yup.string().required().label(\"Name\"),\n\temail: Yup.string().required().email().label(\"Email\"),\n\tpassword: Yup.string().required().min(4).label(\"Password\"),\n});\n\nfunction RegisterScreen() {\n\tconst registerApi = useApi(usersApi.register);\n\tconst loginApi = useApi(authApi.login);\n\tconst auth = useAuth();\n\tconst [error, setError] = useState();\n\n\tconst accountTypes = [\n\t\t{\n\t\t\tbackgroundColor: \"#00b0f0\",\n\t\t\ticon: \"account\",\n\t\t\tlabel: \"Particulier\",\n\t\t\tvalue: 1,\n\t\t},\n\t\t{\n\t\t\tbackgroundColor: \"#00f0b0\",\n\t\t\ticon: \"account-cash\",\n\t\t\tlabel: \"Professionnel\",\n\t\t\tvalue: 2,\n\t\t},\n\t]\n\n\tconst handleSubmit = async (userInfo) => {\n\t\tconst result = await registerApi.request(userInfo);\n\n\t\tif (!result.ok) {\n\t\t\tif (result.data) setError(result.data.error);\n\t\t\telse {\n\t\t\t\tsetError(\"An unexpected error occurred.\");\n\t\t\t\tconsole.log(result);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tconst { data: authToken } = await loginApi.request(\n\t\t\tuserInfo.email,\n\t\t\tuserInfo.password\n\t\t);\n\t\tauth.logIn(authToken);\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<ActivityIndicator\n\t\t\t\tvisible={registerApi.loading || loginApi.loading}\n\t\t\t/>\n\t\t\t<Screen style={styles.container}>\n\t\t\t\t<Form\n\t\t\t\t\tinitialValues={{ accountType: \"\", name: \"\", email: \"\", password: \"\" }}\n\t\t\t\t\tonSubmit={handleSubmit}\n\t\t\t\t\tvalidationSchema={validationSchema}\n\t\t\t\t>\n\t\t\t\t\t<ErrorMessage error={error} visible={error} />\n\t\t\t\t\t<FormPicker\n\t\t\t\t\t\tname=\"accountType\"\n\t\t\t\t\t\tplaceholder=\"Type de compte\" //liste déroulante\n\t\t\t\t\t\titems={accountTypes}\n\t\t\t\t\t\tPickerItemComponent={CategoryPickerItem}\n\t\t\t\t\t\t\n\t\t\t\t\n\t\t\t\t\t/>\n\t\t\t\t\t<FormField\n\t\t\t\t\t\tautoCorrect={false}\n\t\t\t\t\t\ticon=\"account\"\n\t\t\t\t\t\tname=\"name\"\n\t\t\t\t\t\tplaceholder=\"Nom\"\n\t\t\t\t\t/>\n\t\t\t\t\t<FormField\n\t\t\t\t\t\tautoCapitalize=\"none\"\n\t\t\t\t\t\tautoCorrect={false}\n\t\t\t\t\t\ticon=\"email\"\n\t\t\t\t\t\tkeyboardType=\"email-address\"\n\t\t\t\t\t\tname=\"email\"\n\t\t\t\t\t\tplaceholder=\"Email                  \"\n\t\t\t\t\t\ttextContentType=\"emailAddress\"\n\t\t\t\t\t/>\n\t\t\t\t\t<FormField\n\t\t\t\t\t\tautoCapitalize=\"none\"\n\t\t\t\t\t\tautoCorrect={false}\n\t\t\t\t\t\ticon=\"lock\"\n\t\t\t\t\t\tname=\"password\"\n\t\t\t\t\t\tplaceholder=\"Mot de passe\"\n\t\t\t\t\t\tsecureTextEntry\n\t\t\t\t\t\ttextContentType=\"password\"\n\t\t\t\t\t/>\n\t\t\t\t\t<SubmitButton title=\"Inscription\" />\n\t\t\t\t</Form>\n\t\t\t</Screen>\n\t\t</>\n\t);\n}\n\nconst styles = StyleSheet.create({\n\tcontainer: {\n\t\tpadding: 10,\n\t},\n});\n\nexport default RegisterScreen;\n"]},"metadata":{},"sourceType":"module"}