{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\Mansour\\\\Desktop\\\\OrientLine\\\\app\\\\app\\\\screens\\\\ListingEditScreen.js\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport * as Yup from \"yup\";\nimport { Form, FormField, FormPicker, FormImagePicker, SubmitButton } from \"../components/forms\";\nimport Screen from \"../components/Screen\";\nimport listingsApi from \"../api/listings\";\nimport useLocation from \"../hooks/useLocation\";\nimport UploadScreen from \"./UploadScreen\";\nvar validationSchema = Yup.object().shape({\n  title: Yup.string().required().min(1).label(\"Titre\"),\n  description: Yup.string().label(\"Description\"),\n  images: Yup.array().min(1, \"Selectionner au moins une image.\")\n});\n\nfunction ListingEditScreen() {\n  var location = useLocation();\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      uploadVisible = _useState2[0],\n      setUploadVisible = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      progress = _useState4[0],\n      setProgress = _useState4[1];\n\n  var handleSubmit = function handleSubmit(listing, _ref) {\n    var resetForm, result;\n    return _regeneratorRuntime.async(function handleSubmit$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            resetForm = _ref.resetForm;\n            setProgress(0);\n            setUploadVisible(true);\n            _context.next = 5;\n            return _regeneratorRuntime.awrap(listingsApi.addListing(_objectSpread(_objectSpread({}, listing), {}, {\n              location: location\n            }), function (progress) {\n              return setProgress(progress);\n            }));\n\n          case 5:\n            result = _context.sent;\n\n            if (result.ok) {\n              _context.next = 9;\n              break;\n            }\n\n            setUploadVisible(false);\n            return _context.abrupt(\"return\", alert(\"Impossible de poster ce contenu, veuillez reessayer !\"));\n\n          case 9:\n            resetForm();\n\n          case 10:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  return React.createElement(Screen, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 3\n    }\n  }, React.createElement(UploadScreen, {\n    onDone: function onDone() {\n      return setUploadVisible(false);\n    },\n    progress: progress,\n    visible: uploadVisible,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 4\n    }\n  }), React.createElement(Form, {\n    initialValues: {\n      title: \"\",\n      description: \"\",\n      images: []\n    },\n    onSubmit: handleSubmit,\n    validationSchema: validationSchema,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 4\n    }\n  }, React.createElement(FormImagePicker, {\n    name: \"images\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 5\n    }\n  }), React.createElement(FormField, {\n    maxLength: 255,\n    name: \"title\",\n    placeholder: \"Titre\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 5\n    }\n  }), React.createElement(FormField, {\n    name: \"description\",\n    placeholder: \"Contenue\",\n    height: 100,\n    multiline: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 5\n    }\n  }), React.createElement(SubmitButton, {\n    title: \"Publier\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 5\n    }\n  })));\n}\n\nvar styles = StyleSheet.create({\n  container: {\n    padding: 10\n  }\n});\nexport default ListingEditScreen;","map":{"version":3,"sources":["C:/Users/Mansour/Desktop/OrientLine/app/app/screens/ListingEditScreen.js"],"names":["React","useState","Yup","Form","FormField","FormPicker","FormImagePicker","SubmitButton","Screen","listingsApi","useLocation","UploadScreen","validationSchema","object","shape","title","string","required","min","label","description","images","array","ListingEditScreen","location","uploadVisible","setUploadVisible","progress","setProgress","handleSubmit","listing","resetForm","addListing","result","ok","alert","styles","container","StyleSheet","create","padding"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { StyleSheet } from \"react-native\";\nimport * as Yup from \"yup\";\nimport {\n\tForm,\n\tFormField,\n\tFormPicker,\n\tFormImagePicker,\n\tSubmitButton,\n} from \"../components/forms\";\nimport Screen from \"../components/Screen\";\nimport listingsApi from \"../api/listings\";\nimport useLocation from \"../hooks/useLocation\";\n\nimport UploadScreen from \"./UploadScreen\";\n\nconst validationSchema = Yup.object().shape({\n\ttitle: Yup.string().required().min(1).label(\"Titre\"),\n\t//price: Yup.number().required().min(1).max(10000).label(\"Prix\"),\n\tdescription: Yup.string().label(\"Description\"),\n\t//category: Yup.object().required().nullable().label(\"Categorie\"),\n\timages: Yup.array().min(1, \"Selectionner au moins une image.\"),\n});\n\n\nfunction ListingEditScreen() {\n\tconst location = useLocation();\n\tconst [uploadVisible, setUploadVisible] = useState(false);\n\tconst [progress, setProgress] = useState(0);\n\n\tconst handleSubmit = async (listing, { resetForm }) => {\n\t\tsetProgress(0);\n\t\tsetUploadVisible(true);\n\t\tconst result = await listingsApi.addListing(\n\t\t\t{ ...listing, location },\n\t\t\t(progress) => setProgress(progress)\n\t\t);\n\n\t\tif (!result.ok) {\n\t\t\tsetUploadVisible(false);\n\t\t\treturn alert(\"Impossible de poster ce contenu, veuillez reessayer !\");\n\t\t}\n\n\t\tresetForm();\n\t};\n\n\treturn (\n\t\t<Screen style={styles.container}>\n\t\t\t<UploadScreen\n\t\t\t\tonDone={() => setUploadVisible(false)}\n\t\t\t\tprogress={progress}\n\t\t\t\tvisible={uploadVisible}\n\t\t\t/>\n\t\t\t<Form\n\t\t\t\tinitialValues={{\n\t\t\t\t\ttitle: \"\",\n\t\t\t\t\t//price: \"\",\n\t\t\t\t\tdescription: \"\",\n\t\t\t\t\t//category: null,\n\t\t\t\t\timages: [],\n\t\t\t\t}}\n\t\t\t\tonSubmit={handleSubmit}\n\t\t\t\tvalidationSchema={validationSchema}\n\t\t\t>\n\t\t\t\t<FormImagePicker name=\"images\" />\n\n\t\t\t\t<FormField maxLength={255} name=\"title\" placeholder=\"Titre\" />\n\t\t\t\n\t\t\t\t<FormField\n\t\t\t\t\tname=\"description\"\n\t\t\t\t\tplaceholder=\"Contenue\"\n\t\t\t\t\theight={100}\n\t\t\t\t\tmultiline={true}\n\t\t\t\t/>\n\t\t\t\t<SubmitButton title=\"Publier\" />\n\t\t\t</Form>\n\t\t</Screen>\n\t);\n}\n\nconst styles = StyleSheet.create({\n\tcontainer: {\n\t\tpadding: 10,\n\t},\n});\n\nexport default ListingEditScreen;\n"]},"metadata":{},"sourceType":"module"}